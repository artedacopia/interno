<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabela de Preços</title>
    <!-- Importando Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Importando Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Ajustes finos se necessário */
        body { font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
    </style>
</head>
<body class="min-h-screen bg-gray-100 p-6 md:p-10">

    <!-- Barra de Ferramentas / Cabeçalho -->
    <div class="max-w-7xl mx-auto mb-12 flex flex-col md:flex-row justify-between items-center bg-white p-6 rounded-2xl shadow-sm gap-4">
        <div>
            <h1 class="text-3xl font-bold text-gray-800 flex items-center gap-2">
                <i data-lucide="package" class="w-8 h-8 text-blue-600"></i>
                Tabela de Preços
            </h1>
            <p class="text-gray-500 mt-1">
                Visualização dinâmica de produtos e faixas de preço
            </p>
        </div>

        <div class="flex items-center gap-4 bg-gray-50 p-2 rounded-xl border border-gray-200">
            <input type="file" accept=".json" id="json-upload" class="hidden">
            <label for="json-upload" class="flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg cursor-pointer transition-colors font-medium shadow-md">
                <i data-lucide="upload" class="w-4 h-4"></i>
                Carregar JSON
            </label>
            
            <button id="reset-btn" class="px-4 py-2 text-gray-600 hover:bg-gray-200 rounded-lg transition-colors font-medium">
                Restaurar Padrão
            </button>
        </div>
    </div>

    <!-- Mensagem de Erro -->
    <div id="error-container" class="hidden max-w-2xl mx-auto mb-8 p-4 bg-red-50 border border-red-200 text-red-700 rounded-xl flex items-center gap-3">
        <i data-lucide="alert-circle" class="w-5 h-5"></i>
        <span id="error-message"></span>
    </div>

    <!-- Grid de Produtos -->
    <div id="products-grid" class="max-w-[1200px] mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-2 md:gap-6 justify-items-stretch">
        <!-- Os produtos serão injetados aqui via JavaScript -->
    </div>

    <!-- Rodapé Informativo sobre Estrutura JSON -->
    <div class="max-w-3xl mx-auto mt-20 p-6 bg-white rounded-xl shadow-sm border border-gray-200 text-gray-500 text-sm">
        <h3 class="font-bold text-gray-700 mb-2">Estrutura do JSON esperado:</h3>
        <pre class="bg-gray-100 p-4 rounded-lg overflow-x-auto font-mono text-xs">
[
  {
    "id": 1,
    "name": "Nome do Produto",
    "description": "Subtítulo / Detalhes",
    "prices": [
      { "label": "1 uni.", "value": 10.00 },
      { "label": "10 ou +", "value": 8.50 }
    ]
  }
]
        </pre>
    </div>

    <script>
        // --- DADOS DE EXEMPLO (MOCK DATA) ---
        const DEFAULT_PRODUCTS = [
            {
                id: 1,
                name: "Peso 60",
                description: "Só frente",
                prices: [
                    { label: "1 uni.", value: 2.00 },
                    { label: "10 ou +", value: 1.30 },
                    { label: "30 ou +", value: 1.00 }
                ]
            },
            {
                id: 2,
                name: "Peso 60",
                description: "Frente e Verso",
                prices: [
                    { label: "1 uni.", value: 3.00 },
                    { label: "10 ou +", value: 2.00 },
                    { label: "30 ou +", value: 1.75 }
                ]
            },
            {
                id: 3,
                name: "Peso 80",
                description: "Só frente",
                prices: [
                    { label: "1 uni.", value: 2.25 },
                    { label: "10 ou +", value: 1.80 },
                    { label: "30 ou +", value: 1.20 }
                ]
            },
            {
                id: 4,
                name: "Peso 80",
                description: "Frente e verso",
                prices: [
                    { label: "1 uni.", value: 1.00 },
                    { label: "10 ou +", value: 1.00 },
                    { label: "30 ou +", value: 1.00 }
                ]
            },
            {
                id: 5,
                name: "Vinil Avery",
                description: "Sem Verniz",
                prices: [
                    { label: "m²", value: 90.00 },
                    { label: "+ 0,5m²", value: 68.00 },
                    { label: "+ 1m²", value: 65.00 }
                ]
            }
        ];

        let currentProducts = [...DEFAULT_PRODUCTS];

        // --- FUNÇÕES UTILITÁRIAS ---
        const formatCurrency = (value) => {
            return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        };

        // --- RENDERIZAÇÃO ---
        const renderProducts = () => {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = ''; // Limpa o grid

            currentProducts.forEach(product => {
                const card = document.createElement('div');
                // Classes do card container
                card.className = "flex flex-col w-full max-w-[220px] bg-white rounded-[2.5rem] shadow-xl overflow-hidden transform transition-all hover:scale-105 duration-300 mx-auto";

                // Gerar HTML das linhas de preço
                const pricesHTML = product.prices.map((price, index) => {
                    const isLast = index === product.prices.length - 1;
                    const borderClass = isLast ? '' : 'border-b-[3px] border-[#9ca3af]';
                    
                    return `
                        <div class="flex justify-center items-center py-2 ${borderClass}">
                            <div class="flex items-center space-x-2 text-black">
                                <span class="text-lg font-bold text-black whitespace-nowrap">
                                    ${price.label}
                                </span>
                                <span class="text-3xl font-bold text-black">
                                    ${formatCurrency(price.value)}
                                </span>
                            </div>
                        </div>
                    `;
                }).join('');

                // Montar o HTML interno do card
                card.innerHTML = `
                    <!-- Cabeçalho: Nome do Produto -->
                    <div class="bg-black text-white py-3 text-center px-2">
                        <h2 class="text-3xl font-extrabold tracking-tight leading-none">
                            ${product.name}
                        </h2>
                    </div>

                    <!-- Sub-cabeçalho: Descrição -->
                    <div class="bg-[#4a4a4a] text-white py-3 text-center w-full">
                        <span class="text-xl font-bold tracking-wide">
                            ${product.description}
                        </span>
                    </div>

                    <!-- Corpo: Tabela de Preços -->
                    <div class="bg-white flex flex-col w-full px-2 pb-6 pt-2">
                        ${pricesHTML}
                    </div>
                `;

                grid.appendChild(card);
            });
            
            // Re-inicializa os ícones Lucide após renderizar (se houver novos ícones, embora aqui não tenhamos ícones dentro dos cards)
            lucide.createIcons();
        };

        const showError = (msg) => {
            const container = document.getElementById('error-container');
            const messageSpan = document.getElementById('error-message');
            if (msg) {
                messageSpan.textContent = msg;
                container.classList.remove('hidden');
            } else {
                container.classList.add('hidden');
            }
        };

        // --- EVENTOS ---
        
        // Upload de Arquivo
        document.getElementById('json-upload').addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const json = JSON.parse(e.target.result);
                    if (Array.isArray(json)) {
                        currentProducts = json;
                        showError(null);
                        renderProducts();
                    } else {
                        showError("O arquivo JSON deve conter um array de produtos.");
                    }
                } catch (err) {
                    showError("Erro ao ler o arquivo JSON. Verifique a formatação.");
                }
            };
            reader.readAsText(file);
        });

        // Botão Reset
        document.getElementById('reset-btn').addEventListener('click', () => {
            currentProducts = [...DEFAULT_PRODUCTS];
            showError(null);
            document.getElementById('json-upload').value = ""; // Limpa o input file
            renderProducts();
        });

        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            renderProducts();
        });

    </script>
</body>
</html>